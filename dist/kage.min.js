/*! kage.js v0.3.1
 *  Licensed under GPL-3.0
 *  https://github.com/kurgm/kage-engine#readme
 */
var Kage=function(){"use strict";var t=function(){function t(){this.hash={}}return t.prototype.set=function(t,a){this.hash[t]=a},t.prototype.search=function(t){return this.hash[t]?this.hash[t]:""},t.prototype.push=function(t,a){this.set(t,a)},t}(),a=function(){function t(){this.array=[]}return t.prototype.clear=function(){this.array=[]},t.prototype.push=function(t){var a=200,e=0,r=200,n=0;if(!(t.length<3)){for(var i=0,s=t.array;i<s.length;i++){var o=s[i],h=o.x,u=o.y;if(h<a&&(a=h),h>e&&(e=h),u<r&&(r=u),u>n&&(n=u),isNaN(h)||isNaN(u))return}a!==e&&r!==n&&this.array.push(t)}},t.prototype.generateSVG=function(t){var a='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" baseProfile="full" viewBox="0 0 200 200" width="200" height="200">\n';return t?this.array.forEach((function(t){var e=t.array,r="L";a+='<path d="';for(var n=0;n<e.length;n++)0===n?a+="M ":e[n].off?(a+="Q ",r="Q"):"Q"!==r||e[n-1].off?"L"===r&&1===n&&(a+="L "):a+="L ",a+=e[n].x+","+e[n].y+" ";a+='Z" fill="black" />\n'})):(a+='<g fill="black">\n',a+=this.array.map((function(t){return'<polygon points="'+t.array.map((function(t){return t.x+","+t.y+" "})).join("")+'" />\n'})).join(""),a+="</g>\n"),a+="</svg>\n"},t.prototype.generateEPS=function(){var t="";return t+="%!PS-Adobe-3.0 EPSF-3.0\n%%BoundingBox: 0 -208 1024 816\n%%Pages: 0\n%%Title: Kanji glyph\n%%Creator: GlyphWiki powered by KAGE system\n%%CreationDate: "+(new Date).toString()+"\n%%EndComments\n%%EndProlog\n",this.array.forEach((function(a){for(var e=a.array,r=0;r<e.length;r++)t+=5*e[r].x+" "+(1e3-5*e[r].y-200)+" ",t+=0===r?"newpath\nmoveto\n":"lineto\n";t+="closepath\nfill\n"})),t+="%%EOF\n"},t}();function e(t,a,e,r,n){var i,s,o,h;return e<a+100?(i=r,o=r,s=a+100,h=t+100):(i=a+100,o=t+100,s=n,h=n),Math.floor((e-i)/(s-i)*(h-o)+o)}var r=function(){function t(t){this.a1=t[0],this.a2_100=t[1],this.a3_100=t[2],this.x1=t[3],this.y1=t[4],this.x2=t[5],this.y2=t[6],this.x3=t[7],this.y3=t[8],this.x4=t[9],this.y4=t[10],this.kirikuchiAdjustment=Math.floor(this.a2_100/100)%10,this.tateAdjustment=Math.floor(this.a2_100/1e3)%10,this.opt3=Math.floor(this.a2_100/1e4),this.a2_100%=100,this.haneAdjustment=this.urokoAdjustment=this.kakatoAdjustment=Math.floor(this.a3_100/100)%10,this.mageAdjustment=Math.floor(this.a3_100/1e3),this.a3_100%=100}return t.prototype.getControlSegments=function(){var t=[];switch(this.a1){case 0:case 8:case 9:break;case 6:case 7:t.unshift([this.x3,this.y3,this.x4,this.y4]);case 2:case 12:case 3:case 4:t.unshift([this.x2,this.y2,this.x3,this.y3]);default:t.unshift([this.x1,this.y1,this.x2,this.y2])}return t},t.prototype.stretch=function(t,a,r,n,i,s,o,h){this.x1=e(t,a,this.x1,i,s),this.y1=e(r,n,this.y1,o,h),this.x2=e(t,a,this.x2,i,s),this.y2=e(r,n,this.y2,o,h),99!==this.a1&&(this.x3=e(t,a,this.x3,i,s),this.y3=e(r,n,this.y3,o,h),this.x4=e(t,a,this.x4,i,s),this.y4=e(r,n,this.y4,o,h))},t.prototype.getBox=function(){var t=1/0,a=1/0,e=-1/0,r=-1/0;switch(this.a1){default:t=Math.min(t,this.x4),e=Math.max(e,this.x4),a=Math.min(a,this.y4),r=Math.max(r,this.y4);case 2:case 3:case 4:t=Math.min(t,this.x3),e=Math.max(e,this.x3),a=Math.min(a,this.y3),r=Math.max(r,this.y3);case 1:case 99:t=Math.min(t,this.x1,this.x2),e=Math.max(e,this.x1,this.x2),a=Math.min(a,this.y1,this.y2),r=Math.max(r,this.y1,this.y2);case 0:}return{minX:t,maxX:e,minY:a,maxY:r}},t}(),n=Math.hypot||function(t,a){return Math.sqrt(t*t+a*a)};function i(t,a){var e=t[0],r=t[1];if(void 0===a&&(a=1),0===e&&0===r)return[1/e==1/0?a:-a,0];var i=a/n(e,r);return[e*i,r*i]}function s(t,a,e,r){var n=1-r;return n*n*t+n*r*2*a+r*r*e}function o(t,a,e,r){return 2*(r*(t-2*a+e)-t+a)}function h(t,a,e,r,n){var i=1-n;return i*i*i*t+i*i*n*3*a+i*n*n*3*e+n*n*n*r}function u(t,a,e,r,n){return 3*(n*(n*(3*a-t-3*e+r)+2*(t-2*a+e))-t+a)}function k(t,a,e,r){for(void 0===r&&(r=1e-5);a+r<e;){var n=a+(e-a)/3,i=e-(e-a)/3;t(n)<t(i)?e=i:a=n}return a+(e-a)/2}function f(t,a){return void 0===a&&(a=1e8),Math.round(t*a)/a}function c(t,a,e,r){return t*r-e*a}function y(t,a,e,r,n,i,s,o){var h=c(e-t,r-a,s-n,o-i);if(isNaN(h))return!0;if(0===h)return!1;var u=c(e-t,r-a,n-t,i-a),k=c(e-t,r-a,s-t,o-a),y=c(s-n,o-i,t-n,a-i),x=c(s-n,o-i,e-n,r-i);return f(u*k,1e5)<=0&&f(y*x,1e5)<=0}function x(t,a,e,r,n,i){return t.some((function(t,s){return a!==s&&t.getControlSegments().some((function(t){return function(t,a,e,r,n,i,s,o){return!!y(t,a,e,r,n,i,s,i)||(!!y(t,a,e,r,s,i,s,o)||(!!y(t,a,e,r,n,o,s,o)||!!y(t,a,e,r,n,i,n,o)))}(t[0],t[1],t[2],t[3],e,r,n,i)}))}))}function d(t,a,e,r,n,i){return t.some((function(t,s){return a!==s&&t.getControlSegments().some((function(t){return y(t[0],t[1],t[2],t[3],e,r,n,i)}))}))}function M(t,a,e,r,n,i,s){var o=Math.floor(.5*s.length),h=o/s.length,u=t+(e-t)*h,k=a+(r-a)*h,f=e+(n-e)*h,c=r+(i-r)*h,y=u+(f-u)*h,x=k+(c-k)*h;return{index:o,off:[[t,a,u,k,y,x],[y,x,f,c,n,i]]}}function p(t,a,e){var r=t[0],n=r[0],i=r[1],o=t[t.length-1],h=o[0],u=o[1],f=k((function(a){return t.reduce((function(e,r,i){var o=i/(t.length-1),u=s(n,a,h,o);return e+Math.pow(r[0]-u,2)}),0)}),a-8,a+8),c=k((function(a){return t.reduce((function(e,r,n){var o=n/(t.length-1),h=s(i,a,u,o);return e+Math.pow(r[1]-h,2)}),0)}),e-8,e+8);return[n,i,f,c,h,u]}function l(t,a,e,r,n,k,f,c,y,x,d){void 0===d&&(d=i);var M,p,l,v,g={left:[],right:[]};e===n&&r===k?(M=function(a){return s(t,e,f,a)},p=function(t){return s(a,r,c,t)},l=function(a){return o(t,e,f,a)},v=function(t){return o(a,r,c,t)}):(M=function(a){return h(t,e,n,f,a)},p=function(t){return h(a,r,k,c,t)},l=function(a){return u(t,e,n,f,a)},v=function(t){return u(a,r,k,c,t)});for(var j=0;j<=1e3;j+=y){var m=j/1e3,W=M(m),A=p(m),w=l(m),Y=d([-v(m),w],x(m)),b=Y[0],_=Y[1];g.left.push([W-b,A-_]),g.right.push([W+b,A+_])}return g}var v=function(){function t(t){var a=this;if(this._array=[],t)if("number"==typeof t)for(var e=0;e<t;e++)this.push(0,0,!1);else t.forEach((function(t){var e=t.x,r=t.y,n=t.off;a.push(e,r,n)}))}return Object.defineProperty(t.prototype,"array",{get:function(){var t=this;return this._array.map((function(a,e){return t.get(e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._array.length},enumerable:!1,configurable:!0}),t.prototype.push=function(t,a,e){void 0===e&&(e=!1),this._array.push({x:t,y:a,off:e})},t.prototype.set=function(t,a,e,r){void 0===r&&(r=!1),this._array[t].x=a,this._array[t].y=e,this._array[t].off=r},t.prototype.get=function(t){var a=this._array[t],e=a.x,r=a.y,n=a.off;return{x:Math.floor(10*e)/10,y:Math.floor(10*r)/10,off:n}},t.prototype.reverse=function(){this._array.reverse()},t.prototype.concat=function(t){this._array=this._array.concat(t._array)},t.prototype.shift=function(){this._array.shift()},t.prototype.unshift=function(t,a,e){void 0===e&&(e=!1),this._array.unshift({x:t,y:a,off:e})},t.prototype.clone=function(){var a=new t;return this._array.forEach((function(t){var e=t.x,r=t.y,n=t.off;a.push(e,r,n)})),a},t.prototype.translate=function(t,a){return this._array.forEach((function(e){e.x+=t,e.y+=a})),this},t.prototype.transformMatrix=function(t,a,e,r){return this._array.forEach((function(n){var i=n.x,s=n.y;n.x=t*i+a*s,n.y=e*i+r*s})),this},t.prototype.transformMatrix2=function(t,a){return this.transformMatrix(t,-a,a,t)},t.prototype.scale=function(t){return this._array.forEach((function(a){a.x*=t,a.y*=t})),this},t.prototype.reflectX=function(){return this._array.forEach((function(t){t.x*=-1})),this},t.prototype.reflectY=function(){return this._array.forEach((function(t){t.y*=-1})),this},t.prototype.rotate90=function(){return this._array.forEach((function(t){var a=t.x,e=t.y;t.x=-e,t.y=a})),this},t.prototype.rotate180=function(){return this.scale(-1)},t.prototype.rotate270=function(){return this._array.forEach((function(t){var a=t.x,e=t.y;t.x=e,t.y=-a})),this},t.prototype.floor=function(){return this._array.forEach((function(t){var a=t.x,e=t.y;t.x=Math.floor(a),t.y=Math.floor(e)})),this},t}();function g(t,a,e,r,s,o,h,u,k,c,y,x,d,g,j,m){var W,A=y,w=x,Y=t.kMinWidthT-d/2;switch(A%100){case 0:case 7:case 27:W=-1*t.kMinWidthY*.5;break;case 1:case 2:case 6:case 22:case 32:W=0;break;case 12:W=t.kMinWidthY;break;default:return}if(0!==W){var b=e===s&&r===o?[0,W]:i([e-s,r-o],W);e+=b[0],r+=b[1]}var _,S=0,E=n(s-e,o-r)+n(h-s,u-o)+n(k-h,c-u);switch((22===A||27===A)&&7===w&&E<100&&(e+=S=Y>6?(100-E)/100*(Y-6):0),w%100){case 0:case 1:case 7:case 9:case 15:case 14:case 17:case 5:_=0;break;case 8:_=-1*Y*.5;break;default:_=W}if(0!==_){var U=h===k&&u===c?[0,-_]:i([k-h,c-u],_);k+=U[0],c+=U[1]}var K=s===h&&o===u;if(K&&t.kUseCurve){var L=7===A&&0===w?function(t){return 1.1*Math.pow(t,.5)}:7===A?function(t){return Math.pow(t,.5)}:7===w?function(t){return Math.pow(1-t,.5)}:j>0?function(t){return 1-j/2/(Y-m/2)+j/2/(Y-m)*t}:function(){return 1},R=l(e,r,s,o,s,o,k,c,10,(function(t){var a=L(t);return a<.15&&(a=.15),Y*a}),(function(t,a){var e=t[0],r=t[1];return 0===r?[-a,0]:i([e,r],a)})),T=R.left,X=R.right,C=M(e,r,s,o,k,c,T),P=C.off,F=P[0],B=P[1],G=C.index,O=T.slice(0,G+1),D=T.slice(G),N=M(e,r,s,o,k,c,X),z=N.off,Q=z[0],H=z[1],I=N.index,q=p(O,F[2],F[3]),V=p(D,B[2],B[3]),Z=new v([{x:q[0],y:q[1]},{x:q[2],y:q[3],off:!0},{x:q[4],y:q[5]},{x:V[2],y:V[3],off:!0},{x:V[4],y:V[5]}]);(rt=new v([{x:X[0][0],y:X[0][1]},{x:Q[2]-(q[2]-F[2]),y:Q[3]-(q[3]-F[3]),off:!0},{x:X[I][0],y:X[I][1]},{x:H[2]-(V[2]-B[2]),y:H[3]-(V[3]-B[3]),off:!0},{x:X[X.length-1][0],y:X[X.length-1][1]}])).reverse(),Z.concat(rt),a.push(Z)}else{var $=.5;n(k-e,c-r)<50&&($+=.4*(1-n(k-e,c-r)/50));for(var J=7!==A&&27!==A||0!==w?7===A||27===A?K?function(t){return Math.pow(t,$)}:function(t){return Math.pow(Math.pow(t,$),.7)}:7===w?function(t){return Math.pow(1-t,$)}:K&&(j>0||m>0)?function(a){return(t.kMinWidthT-j/2-(m-j)/2*a)/t.kMinWidthT}:function(){return 1}:function(a){return Math.pow(a,$)*t.kL2RDfatten},tt=l(e,r,s,o,h,u,k,c,t.kRate,(function(t){var a=J(t);return a<.15&&(a=.15),Y*a}),(function(t,a){var e=t[0],r=t[1];return 0===f(e)&&0===f(r)?[-a,0]:i([e,r],a)})),at=tt.left,et=tt.right,rt=(Z=new v,new v),nt=0,it=at;nt<it.length;nt++){var st=it[nt],ot=st[0],ht=st[1];Z.push(ot,ht)}for(var ut=0,kt=et;ut<kt.length;ut++){var ft=kt[ut];ot=ft[0],ht=ft[1];rt.push(ot,ht)}if(132===A||22===A&&(K?r>c:e>s))for(var ct=0,yt=rt.length;ct+1<yt;ct++){var xt=rt.get(ct),dt=rt.get(ct+1);if(xt.y<=r&&r<=dt.y){for(var Mt=dt.x+(xt.x-dt.x)*(r-dt.y)/(xt.y-dt.y),pt=r,lt=Z.get(0),vt=Z.get(1),gt=132===A?lt.x+(vt.x-lt.x)*(r-lt.y)/(vt.y-lt.y):lt.x+(vt.x-lt.x+1)*(r-lt.y)/(vt.y-lt.y),jt=132===A?r:r+1,mt=0;mt<ct;mt++)rt.shift();rt.set(0,Mt,pt),Z.unshift(gt,jt);break}}rt.reverse(),Z.concat(rt),a.push(Z)}switch(A){case 12:var Wt=e===s?[0,1]:i([s-e,o-r]),At=Wt[0],wt=Wt[1];Z=new v([{x:-Y,y:0},{x:+Y,y:0},{x:-Y,y:-Y}]).rotate270().transformMatrix2(At,wt).translate(e,r);a.push(Z);break;case 0:var Yt=e===s?[0,1]:i([s-e,o-r]),bt=Yt[0],_t=Yt[1];if(r<=c){var St=Math.atan2(Math.abs(r-o),Math.abs(e-s))/Math.PI*2-.4;Z=new v([{x:-Y,y:1},{x:+Y,y:0},{x:-(Rt=(St*=St>0?2:16)<0?-1:1)*Y,y:-t.kMinWidthY*Math.abs(St)}]).rotate270().transformMatrix2(bt,_t).translate(e,r);a.push(Z);var Et=St<0?-St*t.kMinWidthY:0;(rt=new v).push(Y,-Et),e===s&&r===o?(rt.push(1.5*Y,t.kMinWidthY-Et),rt.push(Y-2,2*t.kMinWidthY+1)):(rt.push(1.5*Y,t.kMinWidthY-1.2*Et),rt.push(Y-2,2*t.kMinWidthY-.8*Et+1)),rt.rotate270().transformMatrix2(bt,_t).translate(e,r),a.push(rt)}else{(Z=new v([{x:0,y:+Y},{x:0,y:-Y},{x:-t.kMinWidthY,y:-Y}])).transformMatrix2(bt,_t).translate(e,r),a.push(Z),(rt=new v([{x:0,y:+Y},{x:+t.kMinWidthY,y:1.5*+Y},{x:3*+t.kMinWidthY,y:.5*+Y}])).transformMatrix2(bt,_t).translate(e,r),a.push(rt)}break;case 22:case 27:(Z=new v([{x:-Y,y:-t.kMinWidthY},{x:0,y:-t.kMinWidthY-t.kWidth},{x:+Y+t.kWidth,y:+t.kMinWidthY},{x:+Y,y:+Y-1}].concat(27===A?[{x:0,y:+Y+2},{x:0,y:0}]:[{x:-Y,y:+Y+4}]))).translate(e-S,r),a.push(Z)}switch(w){case 1:case 8:case 15:var Ut=t.kMinWidthT-m/2,Kt=h===k?[0,1]:u===c?[1,0]:i([k-h,c-u]);At=Kt[0],wt=Kt[1],Z=new v(t.kUseCurve?[{x:0,y:-Ut},{x:.9*+Ut,y:.9*-Ut,off:!0},{x:+Ut,y:0},{x:.9*+Ut,y:.9*+Ut,off:!0},{x:0,y:+Ut}]:[{x:0,y:-Ut},{x:.7*+Ut,y:.7*-Ut},{x:+Ut,y:0},{x:.7*+Ut,y:.7*+Ut},{x:0,y:+Ut}]);if(h===k&&Z.reverse(),Z.transformMatrix2(At,wt).translate(k,c),a.push(Z),15===w){var Lt=new v([{x:0,y:1-Y},{x:2,y:-Y-5*t.kWidth},{x:0,y:-Y-5*t.kWidth},{x:-Y,y:1-Y}]);r>=c&&Lt.rotate180(),Lt.translate(k,c),a.push(Lt)}break;case 0:if(7!==A&&27!==A)break;case 9:St=Math.atan2(Math.abs(c-u),Math.abs(k-h))/Math.PI*2-.6;var Rt=(St*=St>0?8:3)<0?-1:1,Tt=u===c?[1,0]:h===k?[0,c>u?-1:1]:i([k-h,c-u]);At=Tt[0],wt=Tt[1];(Z=new v([{x:0,y:+Y*t.kL2RDfatten},{x:0,y:-Y*t.kL2RDfatten},{x:Math.abs(St)*Y*t.kL2RDfatten,y:Rt*Y*t.kL2RDfatten}])).transformMatrix2(At,wt).translate(k,c),a.push(Z);break;case 14:var Xt=Y>6?6/Y:1,Ct=4*t.kWidth*Math.min(1-g/10,Math.pow(Y/t.kMinWidthT,3))*Xt;(Z=new v([{x:0,y:0},{x:0,y:-Y},{x:-Ct,y:-Y},{x:-Ct,y:.5*-Y}])).translate(k,c),a.push(Z)}}function j(t,a,e,r,n,i,s,o,h,u,k,f,c,y,x,d){g(t,a,e,r,n,i,s,o,h,u,k,f,c,y,x,d)}function m(t,a,e,r,n,i,s,o,h,u,k,f,c,y){g(t,a,e,r,n,i,n,i,s,o,h,u,k,f,c,y)}function W(t,a,e,r,n,s,o,h,u,k,f,c){var y=e,x=r,d=n,M=s,p=o,l=h,g=t.kMinWidthT-u/2;if(y===d||x!==M&&(y>d||Math.abs(M-x)>=Math.abs(d-y)||6===p||6===l)){var j=y===d?[0,1]:i([d-y,M-x]),m=j[0],W=j[1];if(13!==l&&23!==l||0===c){var A=new v(4);switch(p){case 0:A.set(0,y+W*g+m*t.kMinWidthY/2,x-m*g+W*t.kMinWidthY/2),A.set(3,y-W*g-m*t.kMinWidthY/2,x+m*g-W*t.kMinWidthY/2);break;case 1:case 6:A.set(0,y+W*g,x-m*g),A.set(3,y-W*g,x+m*g);break;case 12:A.set(0,y+W*g-m*t.kMinWidthY,x-m*g-W*t.kMinWidthY),A.set(3,y-W*g-m*(g+t.kMinWidthY),x+m*g-W*(g+t.kMinWidthY));break;case 22:if(y===d)A.set(0,y+g,x),A.set(3,y-g,x);else{var w=Math.atan((M-x)/(d-y)),Y=y>d?-1:1;A.set(0,y+(g*Y+1)/Math.sin(w),x+1),A.set(3,y-g*Y/Math.sin(w),x)}break;case 32:y===d?(A.set(0,y+g,x-t.kMinWidthY),A.set(3,y-g,x-t.kMinWidthY)):(A.set(0,y+g/W,x),A.set(3,y-g/W,x))}switch(l){case 0:6===p?(A.set(1,d+W*g,M-m*g),A.set(2,d-W*g,M+m*g)):(A.set(1,d+W*g-m*g/2,M-m*g-W*g/2),A.set(2,d-W*g+m*g/2,M+m*g+W*g/2));break;case 5:if(y===d)break;case 1:A.set(1,d+W*g,M-m*g),A.set(2,d-W*g,M+m*g);break;case 13:A.set(1,d+W*g+m*t.kAdjustKakatoL[f],M-m*g+W*t.kAdjustKakatoL[f]),A.set(2,d-W*g+m*(t.kAdjustKakatoL[f]+g),M+m*g+W*(t.kAdjustKakatoL[f]+g));break;case 23:A.set(1,d+W*g+m*t.kAdjustKakatoR[f],M-m*g+W*t.kAdjustKakatoR[f]),A.set(2,d-W*g+m*(t.kAdjustKakatoR[f]+g),M+m*g+W*(t.kAdjustKakatoR[f]+g));break;case 24:case 32:y===d?(A.set(1,d+g,M+t.kMinWidthY),A.set(2,d-g,M+t.kMinWidthY)):(A.set(1,d+g/W,M),A.set(2,d-g/W,M))}a.push(A)}switch(l){case 24:(A=new v([{x:0,y:+t.kMinWidthY},y===d?{x:+g,y:3*-t.kMinWidthY}:{x:.5*+g,y:4*-t.kMinWidthY},{x:2*+g,y:-t.kMinWidthY},{x:2*+g,y:+t.kMinWidthY}])).translate(d,M),a.push(A);break;case 13:if(4===f&&0===c)if(y===d){(A=new v([{x:-g,y:3*-t.kMinWidthY},{x:2*-g,y:0},{x:-t.kMinWidthY,y:5*+t.kMinWidthY},{x:+g,y:+t.kMinWidthY}])).translate(d,M),a.push(A)}else{var b=y>d&&x!==M?Math.floor((y-d)/(M-x)*3):0;(A=new v([{x:0,y:5*-t.kMinWidthY},{x:2*-g,y:0},{x:-t.kMinWidthY,y:5*+t.kMinWidthY},{x:+g,y:+t.kMinWidthY},{x:0,y:0}])).translate(d+b,M),a.push(A)}}switch(p){case 22:case 27:(A=new v).push(-g,-t.kMinWidthY),A.push(0,-t.kMinWidthY-t.kWidth),A.push(+g+t.kWidth,+t.kMinWidthY),y===d?(A.push(+g,+g),A.push(-g,0)):(A.push(+g,+g-1),27===p?(A.push(0,+g+2),A.push(0,0)):A.push(-g,+g+4)),A.translate(y,x),a.push(A);break;case 0:(A=new v([{x:+g*W+.5*t.kMinWidthY*m,y:+g*-m+.5*t.kMinWidthY*W},{x:+(g+.5*g)*W+(.5*t.kMinWidthY+t.kMinWidthY)*m,y:+(g+.5*g)*-m+(.5*t.kMinWidthY+t.kMinWidthY)*W},y===d?{x:+(g-2)*W+(.5*t.kMinWidthY+2*t.kMinWidthY+1)*m,y:+(g-2)*-m+(.5*t.kMinWidthY+2*t.kMinWidthY+1)*W}:{x:+(g-2)*W+(.5*t.kMinWidthY+2*t.kMinWidthY)*m,y:+(g+1)*-m+(.5*t.kMinWidthY+2*t.kMinWidthY)*W}])).translate(y,x),a.push(A)}if(y===d&&1===l||6===p&&(0===l||y!==d&&5===l)){A=new v;if(t.kUseCurve)A.push(-W*-g,+m*-g),A.push(-m*g*.9+-W*-g*.9,+W*g*.9+m*-g*.9,!0),A.push(+m*g,+W*g),A.push(+m*g*.9+-W*g*.9,+W*g*.9+m*g*.9,!0),A.push(-W*g,+m*g);else{var _=y===d&&(6===p&&0===l||1===l)?.6:.8;A.push(0,-g),A.push(+g*_,.6*-g),A.push(+g,0),A.push(+g*_,.6*+g),A.push(0,+g),A.transformMatrix2(m,W)}if(y===d&&(6===p&&0===l||1===l)&&A.reverse(),A.translate(d,M),a.push(A),y!==d&&6===p&&5===l){var S=5*t.kWidth,E=y<d?1:-1,U=new v([{x:0,y:+E*(1-g)},{x:2,y:+E*(-g-S)},{x:0,y:+E*(-g-S)},{x:-g,y:1-g}]);U.transformMatrix2(m,W).translate(d,M),a.push(U)}}}else if(x===M&&6===p){var K=new v([{x:y,y:x-g},{x:d,y:M-g},{x:d,y:M+g},{x:y,y:x+g}]);switch(a.push(K),l){case 1:case 0:case 5:var L=y<d?[1,0]:[-1,0];m=L[0],W=L[1],_=.6,A=new v(t.kUseCurve?[{x:0,y:-g},{x:.9*+g,y:.9*-g,off:!0},{x:+g,y:0},{x:.9*+g,y:.9*+g,off:!0},{x:0,y:+g}]:[{x:0,y:-g},{x:+g*_,y:.6*-g},{x:+g,y:0},{x:+g*_,y:.6*+g},{x:0,y:+g}]);if(y>=d&&A.reverse(),A.transformMatrix2(m,W).translate(d,M),a.push(A),5===l){S=t.kWidth*(4*(1-u/t.kAdjustMageStep)+1);var R=new v([{x:0,y:-g},{x:2,y:-g-S},{x:0,y:-g-S},{x:-g,y:-g}]);y>=d&&R.reflectX(),R.translate(d,M),a.push(R)}}}else{var T=x===M?[1,0]:i([d-y,M-x]);m=T[0],W=T[1],A=new v([{x:y+W*t.kMinWidthY,y:x-m*t.kMinWidthY},{x:d+W*t.kMinWidthY,y:M-m*t.kMinWidthY},{x:d-W*t.kMinWidthY,y:M+m*t.kMinWidthY},{x:y-W*t.kMinWidthY,y:x+m*t.kMinWidthY}]);switch(a.push(A),l){case 0:if(0===c){var X=(t.kMinWidthU/t.kMinWidthY-1)/4+1,C=new v([{x:+W*t.kMinWidthY,y:-m*t.kMinWidthY},{x:-m*t.kAdjustUrokoX[k]*X,y:-W*t.kAdjustUrokoX[k]*X},{x:-(m-W)*t.kAdjustUrokoX[k]*X/2,y:-(W+m)*t.kAdjustUrokoY[k]*X}]);C.translate(d,M),a.push(C)}}}}function A(t,a,e,r,n){return t.array.filter((function(t){return t.array.every((function(t){var i=t.x,s=t.y;return a<=i&&i<=r&&e<=s&&s<=n}))}))}var w=function(){function t(){this.shotai=U.kMincho,this.kRate=100,this.setSize()}return t.prototype.draw=function(t,a){!function(t,a,e){var r=e.a1,s=e.x1,o=e.y1,h=e.x2,u=e.y2,k=e.x3,f=e.y3,c=e.x4,y=e.y4,x=e.a2_100,d=e.kirikuchiAdjustment,M=e.tateAdjustment,p=e.opt3,l=e.a3_100,v=e.haneAdjustment,g=e.urokoAdjustment,w=e.kakatoAdjustment,Y=e.mageAdjustment;switch(r%100){case 0:if(98===x&&0===d&&0===M&&0===p)for(var b=s+h,_=0,S=0,E=A(a,s,o,h,u);S<E.length;S++){E[S].scale(10).floor().reflectX().translate(10*b,10*_).scale(.1)}else if(97===x&&0===d&&0===M&&0===p){b=0,_=o+u;for(var U=0,K=A(a,s,o,h,u);U<K.length;U++){K[U].scale(10).floor().reflectY().translate(10*b,10*_).scale(.1)}}else if(99===x&&0===d&&0===M&&0===p)if(1===l&&0===v&&0===Y){b=s+u,_=o-s;for(var L=0,R=A(a,s,o,h,u);L<R.length;L++){R[L].scale(10).floor().rotate90().translate(10*b,10*_).scale(.1)}}else if(2===l&&0===v&&0===Y){b=s+h,_=o+u;for(var T=0,X=A(a,s,o,h,u);T<X.length;T++){X[T].scale(10).floor().rotate180().translate(10*b,10*_).scale(.1)}}else if(3===l&&0===v&&0===Y){b=s-o,_=u+s;for(var C=0,P=A(a,s,o,h,u);C<P.length;C++){P[C].scale(10).floor().rotate270().translate(10*b,10*_).scale(.1)}}break;case 1:if(4===l){var F=s===h&&o===u?[0,t.kMage]:i([s-h,o-u],t.kMage);W(t,a,s,o,O=h+F[0],D=u+F[1],x+100*d,1,M+10*p,0,0,0),m(t,a,O,D,h,u,h-t.kMage*((t.kAdjustTateStep+4-M-10*p)/(t.kAdjustTateStep+4)),u,1,14,M,v,p,Y)}else W(t,a,s,o,h,u,x+100*d,l,M+10*p,g,w,Y);break;case 2:if(4===l){var B=h===k?[0,-t.kMage]:u===f?[-t.kMage,0]:i([h-k,u-f],t.kMage);m(t,a,s,o,h,u,O=k+B[0],D=f+B[1],x+100*d,0,M,0,p,0),m(t,a,O,D,k,f,k-t.kMage,f,2,14,M,v,0,Y)}else m(t,a,s,o,h,u,k,f,x+100*d,5===l&&0===v&&0===Y?15:l,M,v,p,Y);break;case 3:var G=s===h&&o===u?[0,t.kMage]:i([s-h,o-u],t.kMage),O=h+G[0],D=u+G[1],N=h===k&&u===f?[0,-t.kMage]:i([k-h,f-u],t.kMage),z=h+N[0],Q=u+N[1];W(t,a,s,o,O,D,x+100*d,1,M+10*p,0,0,0),m(t,a,O,D,h,u,z,Q,1,1,0,0,M+10*p,Y),(5!==l||0!==v||(h<k&&k-z>0||h>k&&z-k>0))&&W(t,a,z,Q,k,f,6,l,Y,g,w,5===l&&0===v?0:Y);break;case 12:m(t,a,s,o,h,u,k,f,x+100*d,1,M,0,p,0),W(t,a,k,f,c,y,6,l,0,g,w,Y);break;case 4:var H=n(k-h,f-u)/120*6;H>6&&(H=6);var I=s===h&&o===u?[0,t.kMage*H]:i([s-h,o-u],t.kMage*H),q=(O=h+I[0],D=u+I[1],h===k&&u===f?[0,-t.kMage*H]:i([k-h,f-u],t.kMage*H));z=h+q[0],Q=u+q[1];W(t,a,s,o,O,D,x+100*d,1,M+10*p,0,0,0),m(t,a,O,D,h,u,z,Q,1,1,0,0,0,0),5===l&&0===v&&0===Y&&k-z<=0||W(t,a,z,Q,k,f,6,l,0,g,w,Y);break;case 6:if(4===l){var V=k===c?[0,-t.kMage]:f===y?[-t.kMage,0]:i([k-c,f-y],t.kMage);j(t,a,s,o,h,u,k,f,O=c+V[0],D=y+V[1],x+100*d,1,M,0,p,0),m(t,a,O,D,c,y,c-t.kMage,y,1,14,0,v,0,Y)}else j(t,a,s,o,h,u,k,f,c,y,x+100*d,5===l&&0===v&&0===Y?15:l,M,v,p,Y);break;case 7:W(t,a,s,o,h,u,x+100*d,1,M+10*p,0,0,0),m(t,a,h,u,k,f,c,y,1,l,M,v,p,Y)}}(this,t,a)},t.prototype.setSize=function(t){1===t?(this.kMinWidthY=1.2,this.kMinWidthT=3.6,this.kWidth=3,this.kKakato=1.8,this.kL2RDfatten=1.1,this.kMage=6,this.kUseCurve=!1,this.kAdjustKakatoL=[8,5,3,1,0],this.kAdjustKakatoR=[4,3,2,1],this.kAdjustKakatoRangeX=12,this.kAdjustKakatoRangeY=[1,11,14,18],this.kAdjustKakatoStep=3,this.kAdjustUrokoX=[14,12,9,7],this.kAdjustUrokoY=[7,6,5,4],this.kAdjustUrokoLength=[13,21,30],this.kAdjustUrokoLengthStep=3,this.kAdjustUrokoLine=[13,15,18]):(this.kMinWidthY=2,this.kMinWidthU=2,this.kMinWidthT=6,this.kWidth=5,this.kKakato=3,this.kL2RDfatten=1.1,this.kMage=10,this.kUseCurve=!1,this.kAdjustKakatoL=[14,9,5,2,0],this.kAdjustKakatoR=[8,6,4,2],this.kAdjustKakatoRangeX=20,this.kAdjustKakatoRangeY=[1,19,24,30],this.kAdjustKakatoStep=3,this.kAdjustUrokoX=[24,20,16,12],this.kAdjustUrokoY=[12,11,9,8],this.kAdjustUrokoLength=[22,36,50],this.kAdjustUrokoLengthStep=3,this.kAdjustUrokoLine=[22,26,30],this.kAdjustUroko2Step=3,this.kAdjustUroko2Length=40,this.kAdjustTateStep=4,this.kAdjustMageStep=5)},t.prototype.adjustStrokes=function(t){return this.adjustHane(t),this.adjustMage(t),this.adjustTate(t),this.adjustKakato(t),this.adjustUroko(t),this.adjustUroko2(t),this.adjustKirikuchi(t),t},t.prototype.adjustHane=function(t){return t.forEach((function(a,e){if((1===a.a1||2===a.a1||6===a.a1)&&4===a.a3_100&&0===a.haneAdjustment&&0===a.mageAdjustment){var r,n;1===a.a1?(r=a.x2,n=a.y2):2===a.a1?(r=a.x3,n=a.y3):(r=a.x4,n=a.y4);var i=1/0;r+18<100&&(i=r+18),t.forEach((function(t,a){e!==a&&1===t.a1&&t.x1===t.x2&&t.x1<r&&t.y1<=n&&t.y2>=n&&r-t.x1<100&&(i=Math.min(i,r-t.x1))})),i!==1/0&&(a.haneAdjustment+=7-Math.floor(i/15))}})),t},t.prototype.adjustMage=function(t){var a=this;return t.forEach((function(e,r){3===e.a1&&e.y2===e.y3&&t.forEach((function(t,n){r!==n&&(1===t.a1&&t.y1===t.y2&&!(e.x2+1>t.x2||e.x3-1<t.x1)&&f(Math.abs(e.y2-t.y1))<a.kMinWidthT*a.kAdjustMageStep||3===t.a1&&t.y2===t.y3&&!(e.x2+1>t.x3||e.x3-1<t.x2)&&f(Math.abs(e.y2-t.y2))<a.kMinWidthT*a.kAdjustMageStep)&&(e.mageAdjustment+=a.kAdjustMageStep-Math.floor(Math.abs(e.y2-t.y2)/a.kMinWidthT),e.mageAdjustment>a.kAdjustMageStep&&(e.mageAdjustment=a.kAdjustMageStep))}))})),t},t.prototype.adjustTate=function(t){var a=this;return t.forEach((function(e,r){1!==e.a1&&3!==e.a1&&7!==e.a1||e.x1!==e.x2||t.forEach((function(t,n){r!==n&&(1===t.a1||3===t.a1||7===t.a1)&&t.x1===t.x2&&!(e.y1+1>t.y2||e.y2-1<t.y1)&&f(Math.abs(e.x1-t.x1))<a.kMinWidthT*a.kAdjustTateStep&&(e.tateAdjustment+=a.kAdjustTateStep-Math.floor(Math.abs(e.x1-t.x1)/a.kMinWidthT),e.tateAdjustment>a.kAdjustTateStep&&(e.tateAdjustment=a.kAdjustTateStep))}))})),t},t.prototype.adjustKakato=function(t){var a=this;return t.forEach((function(e,r){if(1===e.a1&&(13===e.a3_100||23===e.a3_100)&&0===e.kakatoAdjustment&&0===e.mageAdjustment)for(var n=0;n<a.kAdjustKakatoStep;n++)if(x(t,r,e.x2-a.kAdjustKakatoRangeX/2,e.y2+a.kAdjustKakatoRangeY[n],e.x2+a.kAdjustKakatoRangeX/2,e.y2+a.kAdjustKakatoRangeY[n+1])||f(e.y2+a.kAdjustKakatoRangeY[n+1])>200||f(e.y2-e.y1)<a.kAdjustKakatoRangeY[n+1]){e.kakatoAdjustment=3-n;break}})),t},t.prototype.adjustUroko=function(t){var a=this;return t.forEach((function(e,r){if(1===e.a1&&0===e.a3_100&&0===e.urokoAdjustment&&0===e.mageAdjustment)for(var s=0;s<a.kAdjustUrokoLengthStep;s++){var o=void 0,h=void 0,u=void 0;if(e.y1===e.y2)o=e.x2-a.kAdjustUrokoLine[s],h=e.y2-.5,u=e.x2-e.x1;else{var k=e.x1===e.x2?[0,(e.y2-e.y1)/(e.x2-e.x1)>0?1:-1]:e.x2-e.x1<0?i([e.x1-e.x2,e.y1-e.y2]):i([e.x2-e.x1,e.y2-e.y1]),c=k[0],y=k[1];o=e.x2-a.kAdjustUrokoLine[s]*c-.5*y,h=e.y2-a.kAdjustUrokoLine[s]*y-.5*c,u=n(e.y2-e.y1,e.x2-e.x1)}if(f(u)<a.kAdjustUrokoLength[s]||d(t,r,o,h,e.x2,e.y2)){e.urokoAdjustment=a.kAdjustUrokoLengthStep-s;break}}})),t},t.prototype.adjustUroko2=function(t){var a=this;return t.forEach((function(e,r){if(1===e.a1&&0===e.a3_100&&0===e.urokoAdjustment&&0===e.mageAdjustment&&e.y1===e.y2){var n=0;t.forEach((function(t,i){r!==i&&(1===t.a1&&t.y1===t.y2&&!(e.x1+1>t.x2||e.x2-1<t.x1)&&f(Math.abs(e.y1-t.y1))<a.kAdjustUroko2Length||3===t.a1&&t.y2===t.y3&&!(e.x1+1>t.x3||e.x2-1<t.x2)&&f(Math.abs(e.y1-t.y2))<a.kAdjustUroko2Length)&&(n+=Math.pow(a.kAdjustUroko2Length-Math.abs(e.y1-t.y2),1.1))})),e.urokoAdjustment=Math.min(Math.floor(n/a.kAdjustUroko2Length),a.kAdjustUroko2Step)}})),t},t.prototype.adjustKirikuchi=function(t){return t.forEach((function(a){if(2===a.a1&&32===a.a2_100&&0===a.kirikuchiAdjustment&&0===a.tateAdjustment&&0===a.opt3&&a.x1>a.x2&&a.y1<a.y2)for(var e=0,r=t;e<r.length;e++){var n=r[e];if(1===n.a1&&n.x1<a.x1&&n.x2>a.x1&&n.y1===a.y1&&n.y1===n.y2){a.kirikuchiAdjustment=1;break}}})),t},t}(),Y=function(t,a){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var e in a)a.hasOwnProperty(e)&&(t[e]=a[e])})(t,a)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function b(t,a,e,r,n,s,o,h,u,k,c,y){var x=y,d=0;switch(c%10){case 2:d=t.kWidth;break;case 3:d=t.kWidth*t.kKakato}if(0!==d){var M=e===n&&r===s?[0,d]:i([e-n,r-s],d);e+=M[0],r+=M[1]}var p=0;switch(x%10){case 2:p=t.kWidth;break;case 3:p=t.kWidth*t.kKakato}if(0!==p){var g=o===u&&h===k?[0,-p]:i([u-o,k-h],p);u+=g[0],k+=g[1]}for(var j=l(e,r,n,s,o,h,u,k,t.kRate,(function(){return t.kWidth}),(function(t,a){var e=t[0],r=t[1];return 0===f(e)&&0===f(r)?[-a,0]:i([e,r],a)})),m=j.left,W=j.right,A=new v,w=new v,Y=0,b=m;Y<b.length;Y++){var _=b[Y],S=_[0],E=_[1];A.push(S,E)}for(var U=0,K=W;U<K.length;U++){var L=K[U];S=L[0],E=L[1];w.push(S,E)}w.reverse(),A.concat(w),a.push(A)}function _(t,a,e,r,n,i,s,o,h,u,k,f){b(t,a,e,r,n,i,s,o,h,u,k,f)}function S(t,a,e,r,n,i,s,o,h,u){b(t,a,e,r,n,i,n,i,s,o,h,u)}function E(t,a,e,r,n,s,o,h){var u,k,f,c,y,x;e===n&&r>s||e>n?(u=n,k=s,f=e,c=r,y=h,x=o):(u=e,k=r,f=n,c=s,y=o,x=h);var d=u===f&&k===c?[0,1]:i([f-u,c-k]),M=d[0],p=d[1],l=0;switch(y%10){case 2:l=t.kWidth;break;case 3:l=t.kWidth*t.kKakato}0!==l&&(u-=M*l,k-=p*l);var g=0;switch(x%10){case 2:g=t.kWidth;break;case 3:g=t.kWidth*t.kKakato}0!==g&&(f+=M*g,c+=p*g);var j=new v([{x:u+p*t.kWidth,y:k-M*t.kWidth},{x:f+p*t.kWidth,y:c-M*t.kWidth},{x:f-p*t.kWidth,y:c+M*t.kWidth},{x:u-p*t.kWidth,y:k+M*t.kWidth}]);e===n&&j.reverse(),a.push(j)}var U,K=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.shotai=U.kGothic,a}return function(t,a){function e(){this.constructor=t}Y(t,a),t.prototype=null===a?Object.create(a):(e.prototype=a.prototype,new e)}(a,t),a.prototype.draw=function(t,a){!function(t,a,e){var r=e.a1,n=e.x1,s=e.y1,o=e.x2,h=e.y2,u=e.x3,k=e.y3,f=e.x4,c=e.y4,y=e.a2_100,x=e.a3_100,d=e.haneAdjustment,M=e.mageAdjustment;switch(r%100){case 0:break;case 1:if(4===x&&0===d&&0===M){var p=n===o&&s===h?[0,t.kMage]:i([n-o,s-h],t.kMage);E(t,a,n,s,W=o+p[0],v=h+p[1],y,1),S(t,a,W,v,o,h,o-2*t.kMage,h-.5*t.kMage,1,0)}else E(t,a,n,s,o,h,y,x);break;case 2:case 12:if(4===x&&0===d&&0===M){var l=o===u?[0,-t.kMage]:h===k?[-t.kMage,0]:i([o-u,h-k],t.kMage);S(t,a,n,s,o,h,W=u+l[0],v=k+l[1],y,1),S(t,a,W,v,u,k,u-2*t.kMage,k-.5*t.kMage,1,0)}else if(5===x&&0===d&&0===M){var v=k,g=(W=u+t.kMage)+.5*t.kMage,j=k-2*t.kMage;S(t,a,n,s,o,h,u,k,y,1),S(t,a,u,k,W,v,g,j,1,0)}else S(t,a,n,s,o,h,u,k,y,x);break;case 3:var m=n===o&&s===h?[0,t.kMage]:i([n-o,s-h],t.kMage),W=o+m[0],A=(v=h+m[1],o===u&&h===k?[0,-t.kMage]:i([u-o,k-h],t.kMage));g=o+A[0],j=h+A[1];if(E(t,a,n,s,W,v,y,1),S(t,a,W,v,o,h,g,j,1,1),5===x&&0===d&&0===M){var w=u-t.kMage,Y=k,b=u+.5*t.kMage,U=k-2*t.kMage;E(t,a,g,j,w,Y,1,1),S(t,a,w,Y,u,k,b,U,1,0)}else E(t,a,g,j,u,k,1,x);break;case 6:if(5===x&&0===d&&0===M){W=f-t.kMage,v=c,g=f+.5*t.kMage,j=c-2*t.kMage;_(t,a,n,s,o,h,u,k,W,v,y,1),S(t,a,W,v,f,c,g,j,1,0)}else _(t,a,n,s,o,h,u,k,f,c,y,x);break;case 7:E(t,a,n,s,o,h,y,1),S(t,a,o,h,u,k,f,c,1,x)}}(this,t,a)},a}(w);function L(t){switch(t){case U.kMincho:return new w;default:return new K}}return function(t){t[t.kMincho=0]="kMincho",t[t.kGothic=1]="kGothic"}(U||(U={})),function(){function n(a){this.kMincho=U.kMincho,this.kGothic=U.kGothic,this.kFont=L(U.kMincho),this.stretch=e,this.kFont.setSize(a),this.kBuhin=new t}return Object.defineProperty(n.prototype,"kShotai",{get:function(){return this.kFont.shotai},set:function(t){this.kFont=L(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"kUseCurve",{get:function(){return this.kFont.kUseCurve},set:function(t){this.kFont.kUseCurve=t},enumerable:!1,configurable:!0}),n.prototype.makeGlyph=function(t,a){var e=this.kBuhin.search(a);this.makeGlyph2(t,e)},n.prototype.makeGlyph2=function(t,a){var e=this;if(""!==a){var r=this.getEachStrokes(a);this.kFont.adjustStrokes(r),r.forEach((function(a){e.kFont.draw(t,a)}))}},n.prototype.makeGlyph3=function(t){var e=this,r=[];if(""!==t){var n=this.getEachStrokes(t);this.kFont.adjustStrokes(n),n.forEach((function(t){var n=new a;e.kFont.draw(n,t),r.push(n)}))}return r},n.prototype.makeGlyphSeparated=function(t){var e=this,r=t.map((function(t){return e.getEachStrokes(t)}));this.kFont.adjustStrokes(r.reduce((function(t,a){return t.concat(a)}),[]));var n=new a;return r.map((function(t){var r=n.array.length;t.forEach((function(t){e.kFont.draw(n,t)}));var i=new a;return i.array=n.array.slice(r),i}))},n.prototype.getEachStrokes=function(t){var a=this,e=[];return t.split("$").forEach((function(t){var n=t.split(":");if(99!==Math.floor(+n[0]))e.push(new r([Math.floor(+n[0]),Math.floor(+n[1]),Math.floor(+n[2]),Math.floor(+n[3]),Math.floor(+n[4]),Math.floor(+n[5]),Math.floor(+n[6]),Math.floor(+n[7]),Math.floor(+n[8]),Math.floor(+n[9]),Math.floor(+n[10])]));else{var i=a.kBuhin.search(n[7]);""!==i&&(e=e.concat(a.getEachStrokesOfBuhin(i,Math.floor(+n[3]),Math.floor(+n[4]),Math.floor(+n[5]),Math.floor(+n[6]),Math.floor(+n[1]),Math.floor(+n[2]),Math.floor(+n[9]),Math.floor(+n[10]))))}})),e},n.prototype.getEachStrokesOfBuhin=function(t,a,e,r,n,i,s,o,h){var u=this.getEachStrokes(t),k=this.getBox(u);return 0===i&&0===s||(i>100?i-=200:(o=0,h=0)),u.forEach((function(t){0===i&&0===s||t.stretch(i,o,s,h,k.minX,k.maxX,k.minY,k.maxY),t.x1=a+t.x1*(r-a)/200,t.y1=e+t.y1*(n-e)/200,t.x2=a+t.x2*(r-a)/200,t.y2=e+t.y2*(n-e)/200,t.x3=a+t.x3*(r-a)/200,t.y3=e+t.y3*(n-e)/200,t.x4=a+t.x4*(r-a)/200,t.y4=e+t.y4*(n-e)/200})),u},n.prototype.getBox=function(t){var a=200,e=200,r=0,n=0;return t.forEach((function(t){var i=t.getBox(),s=i.minX,o=i.maxX,h=i.minY,u=i.maxY;a=Math.min(a,s),r=Math.max(r,o),e=Math.min(e,h),n=Math.max(n,u)})),{minX:a,maxX:r,minY:e,maxY:n}},n.Buhin=t,n.Polygons=a,n}()}();
